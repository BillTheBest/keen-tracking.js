{"version":3,"names":[],"mappings":"","sources":["keen-tracking.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (global){\n;(function (f) {\n  // RequireJS\n  if (typeof define === 'function' && define.amd) {\n    define('keen', [], function(){ return f(); });\n  }\n  // CommonJS\n  if (typeof exports === 'object' && typeof module !== 'undefined') {\n    module.exports = f();\n  }\n  // Global\n  var g = null;\n  if (typeof window !== 'undefined') {\n    g = window;\n  } else if (typeof global !== 'undefined') {\n    g = global;\n  } else if (typeof self !== 'undefined') {\n    g = self;\n  }\n  if (g) {\n    g.Keen = f();\n  }\n})(function() {\n  'use strict';\n\n  var Keen = require('./');\n  var extend = require('./utils/extend');\n\n  // ------------------------\n  // Methods\n  // ------------------------\n  extend(Keen.Client.prototype, {\n    // 'deferEvent'   : require('./deferEvent'),\n    // 'deferEvents'  : require('./deferEvents'),\n    // 'extendEvent'  : require('./extendEvent'),\n    // 'extendEvents' : require('./extendEvents'),\n    'recordEvent'  : require('./recordEvent'),\n    'recordEvents' : require('./recordEvents')\n  });\n\n  // ------------------------\n  // Helpers\n  // ------------------------\n  extend(Keen.helpers, {\n    'getBrowserProfile'  : require('./helpers/getBrowserProfile'),\n    'getDatetimeIndex'   : require('./helpers/getDatetimeIndex'),\n    'getDomEventProfile' : require('./helpers/getDomEventProfile'),\n    'getDomNodePath'     : require('./helpers/getDomNodePath'),\n    'getScreenProfile'   : require('./helpers/getScreenProfile'),\n    'getUniqueId'        : require('./helpers/getUniqueId'),\n    'getWindowProfile'   : require('./helpers/getWindowProfile')\n  });\n\n  // ------------------------\n  // Utils\n  // ------------------------\n  extend(Keen.utils, {\n    'each'       : require('./utils/each'),\n    'extend'     : extend,\n    'parseParams': require('./utils/parseParams')\n  });\n\n  // ------------------------\n  // Process async queue\n  // ------------------------\n  // ...\n\n  module.exports = Keen;\n  return Keen;\n});\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./\":9,\"./helpers/getBrowserProfile\":2,\"./helpers/getDatetimeIndex\":3,\"./helpers/getDomEventProfile\":4,\"./helpers/getDomNodePath\":5,\"./helpers/getScreenProfile\":6,\"./helpers/getUniqueId\":7,\"./helpers/getWindowProfile\":8,\"./recordEvent\":10,\"./recordEvents\":11,\"./utils/each\":12,\"./utils/extend\":13,\"./utils/parseParams\":14}],2:[function(require,module,exports){\nvar getScreenProfile = require('./getScreenProfile'),\n    getWindowProfile = require('./getWindowProfile');\n\nfunction getBrowserProfile(){\n  return {\n    'cookies'  : ('undefined' !== typeof navigator.cookieEnabled) ? navigator.cookieEnabled : false,\n    'codeName' : navigator.appCodeName,\n    'language' : navigator.language,\n    'name'     : navigator.appName,\n    'online'   : navigator.onLine,\n    'platform' : navigator.platform,\n    'useragent': navigator.userAgent,\n    'version'  : navigator.appVersion,\n    'screen'   : getScreenProfile(),\n    'window'   : getWindowProfile()\n  }\n}\n\nmodule.exports = getBrowserProfile;\n\n},{\"./getScreenProfile\":6,\"./getWindowProfile\":8}],3:[function(require,module,exports){\nfunction getDateTimeIndex(input){\n  var date = input || new Date();\n  return {\n    'hour-of-day'  : date.getHours(),\n    'day-of-week'  : parseInt( 1 + date.getDay() ),\n    'day-of-month' : date.getDate(),\n    'month'        : parseInt( 1 + date.getMonth() ),\n    'year'         : date.getFullYear()\n  };\n}\n\nmodule.exports = getDateTimeIndex;\n\n},{}],4:[function(require,module,exports){\nfunction getDomEventProfile(e){\n  if (!arguments.length) return {};\n  return {\n    'innerText': e.target.innerText,\n    'path': Keen.helpers.getDomPath(e.target).join(' > '),\n    'tagName': e.target.tagName,\n    'title': e.target.title\n  };\n}\n\nmodule.exports = getDomEventProfile;\n\n},{}],5:[function(require,module,exports){\n/*!\n  via: http://stackoverflow.com/a/16742828/2511985\n  */\n\nfunction getDomNodePath(el){\n  if (!el.nodeName) return '';\n\n  var stack = [];\n  while ( el.parentNode != null ) {\n    // console.log(el.nodeName);\n    var sibCount = 0;\n    var sibIndex = 0;\n    for ( var i = 0; i < el.parentNode.childNodes.length; i++ ) {\n      var sib = el.parentNode.childNodes[i];\n      if ( sib.nodeName == el.nodeName ) {\n        if ( sib === el ) {\n          sibIndex = sibCount;\n        }\n        sibCount++;\n      }\n    }\n    if ( el.hasAttribute('id') && el.id != '' ) {\n      stack.unshift(el.nodeName.toLowerCase() + '#' + el.id);\n    } else if ( sibCount > 1 ) {\n      stack.unshift(el.nodeName.toLowerCase() + ':eq(' + sibIndex + ')');\n    } else {\n      stack.unshift(el.nodeName.toLowerCase());\n    }\n    el = el.parentNode;\n  }\n\n  return stack.slice(1); // removes the html element\n}\n\nmodule.exports = getDomNodePath;\n\n},{}],6:[function(require,module,exports){\nfunction getScreenProfile(){\n  var keys, output;\n\n  if ('undefined' == typeof window || !window.screen) return {};\n\n  keys = ['height', 'width', 'colorDepth', 'pixelDepth', 'availHeight', 'availWidth'];\n  output = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    output[keys[i]] = window.screen[keys[i]] ? window.screen[keys[i]] : null;\n  }\n\n  output.orientation = {\n    'angle' : window.screen.orientation ? window.screen.orientation['angle'] : 0,\n    'type'  : window.innerWidth > window.innerHeight ? 'landscape': 'portrait'\n  };\n\n  return output;\n}\n\nmodule.exports = getScreenProfile;\n\n},{}],7:[function(require,module,exports){\nfunction getUniqueId(){\n\n}\n\nmodule.exports = getUniqueId;\n\n},{}],8:[function(require,module,exports){\nfunction getWindowProfile(){\n  var body, html, output;\n\n  if ('undefined' == typeof document) return {};\n\n  body = document.body;\n  html = document.documentElement;\n\n  output = {\n    'height': window.innerHeight || null,\n    'width': window.innerWidth || null,\n    'scrollHeight': Math.max( body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight ) || null\n  };\n\n  if (window.screen) {\n    output.ratio = {\n      'height': (window.screen.availHeight) ? parseFloat( (window.innerHeight/window.screen.availHeight).toFixed(2) ) : null,\n      'width': (window.screen.availWidth) ? parseFloat( (window.innerWidth/window.screen.availWidth).toFixed(2) ) : null\n    };\n  }\n\n  return output;\n}\n\nmodule.exports = getWindowProfile;\n\n},{}],9:[function(require,module,exports){\nvar Emitter = require('component-emitter');\n\nvar root = this;\nvar previousKeen = root.Keen;\n\nvar Keen = {\n  debug: false,\n  enabled: true,\n  helpers: {},\n  utils: {},\n  version: '0.0.0'\n};\n// Keen.loaded = true;\n\nKeen.Client = function(cfg){\n  this.configure(cfg);\n  Keen.emit('client', this);\n}\n\nKeen.Client.prototype.configure = function(cfg){\n  var config = cfg || {};\n  if (config['host']) {\n    config['host'].replace(/.*?:\\/\\//g, '');\n  }\n  if (config.protocol && config.protocol === 'auto') {\n    config['protocol'] = location.protocol.replace(/:/g, '');\n  }\n  this.config = {\n    projectId   : config.projectId,\n    writeKey    : config.writeKey,\n    // readKey     : config.readKey,\n    // masterKey   : config.masterKey,\n    requestType : config.requestType || 'jsonp',\n    host        : config['host']     || 'api.keen.io/3.0',\n    protocol    : config['protocol'] || 'https'\n    // globalProperties: null\n  };\n  if (Keen.debug) {\n    this.on('error', Keen.log);\n  }\n  this.emit('ready');\n};\n\nKeen.Client.prototype.projectId = function(str){\n  if (!arguments.length) return this.config.projectId;\n  this.config.projectId = (str ? String(str) : null);\n  return this;\n};\n\nKeen.Client.prototype.masterKey = function(str){\n  if (!arguments.length) return this.config.masterKey;\n  this.config.masterKey = (str ? String(str) : null);\n  return this;\n};\n\nKeen.Client.prototype.readKey = function(str){\n  if (!arguments.length) return this.config.readKey;\n  this.config.readKey = (str ? String(str) : null);\n  return this;\n};\n\nKeen.Client.prototype.writeKey = function(str){\n  if (!arguments.length) return this.config.writeKey;\n  this.config.writeKey = (str ? String(str) : null);\n  return this;\n};\n\nKeen.Client.prototype.url = function(path){\n  if (!this.projectId()) {\n    this.emit('error', 'Keen.Client is missing a projectId property');\n    return;\n  }\n  return this.config.protocol + '://' + this.config.host + '/projects/' + this.projectId() + path;\n};\n\nEmitter(Keen);\nEmitter(Keen.Client.prototype);\n\nKeen.log = function(message) {\n  if (Keen.debug && typeof console == 'object') {\n    console.log('[Keen IO]', message);\n  }\n};\n\nKeen.noConflict = function(){\n  root.Keen = previousKeen;\n  return Keen;\n};\n\nmodule.exports = Keen;\n\n},{\"component-emitter\":15}],10:[function(require,module,exports){\nfunction recordEvent(eventCollection, eventBody, callback){\n\n}\n\nmodule.exports = recordEvent;\n\n},{}],11:[function(require,module,exports){\nfunction recordEvents(events, callback){\n\n}\n\nmodule.exports = recordEvents;\n\n},{}],12:[function(require,module,exports){\nmodule.exports = function(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n};\n\n},{}],13:[function(require,module,exports){\nmodule.exports = function(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n\n},{}],14:[function(require,module,exports){\nfunction parseParams(str){\n  // via: http://stackoverflow.com/a/2880929/2511985\n  var urlParams = {},\n      match,\n      pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n      search = /([^&=]+)=?([^&]*)/g,\n      decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); },\n      query  = str.split(\"?\")[1];\n\n  while (!!(match=search.exec(query))) {\n    urlParams[decode(match[1])] = decode(match[2]);\n  }\n  return urlParams;\n};\n\nmodule.exports = parseParams;\n\n},{}],15:[function(require,module,exports){\n\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks['$' + event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n},{}]},{},[1]);\n"],"file":"keen-tracking.js","sourceRoot":"/source/"}